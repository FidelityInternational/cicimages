#!/usr/bin/env bash
CURRENT_PATH="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# shellcheck source=image/bin/support/sh/functions/output.sh
source "${CURRENT_PATH}/support/sh/functions/output.sh"

# shellcheck source=image/bin/support/sh/functions/wrapped_commands.sh
source "${CURRENT_PATH}/support/sh/functions/wrapped_commands.sh"

# shellcheck source=image/bin/support/sh/functions/cic.sh
source "${CURRENT_PATH}/support/sh/functions/cic.sh"

docker run -t --privileged \
    --network "$(cic_network)" \
    -v "$(working_directory)":"$(cic_working_dir)" \
    -w "$(cic_working_dir)" \
    "cicimages/wrappers-ansible:latest" \
    /bin/bash -ilc "$(build_command "ansible-playbook" "$@")"